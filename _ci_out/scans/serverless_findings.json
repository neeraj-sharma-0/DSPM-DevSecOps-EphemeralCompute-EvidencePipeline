[
  {
    "file": "/content/drive/MyDrive/DSPM-DevSecOps-EphemeralCompute-EvidencePipeline/examples/iac/serverless/serverless.yml",
    "function": "ingest",
    "severity": "MEDIUM",
    "message": "Event-triggered function: ensure least-privilege + event source allowlist",
    "evidence": {
      "event": {
        "s3": {
          "bucket": "demo-bucket",
          "event": "s3:ObjectCreated:*"
        }
      }
    }
  },
  {
    "file": "/content/drive/MyDrive/DSPM-DevSecOps-EphemeralCompute-EvidencePipeline/examples/iac/serverless/serverless.yml",
    "function": "ingest",
    "severity": "HIGH",
    "message": "Potential secret-like keys in function environment (use secrets manager + runtime fetch)",
    "evidence": {
      "environment_keys": [
        "API_KEY"
      ]
    }
  },
  {
    "file": "/content/drive/MyDrive/DSPM-DevSecOps-EphemeralCompute-EvidencePipeline/examples/iac/serverless/serverless.yml",
    "function": "ingest",
    "severity": "LOW",
    "message": "Provider logging not explicitly configured; ensure retention + redaction policy",
    "evidence": {
      "provider_logs": {}
    }
  },
  {
    "file": "/content/drive/MyDrive/DSPM-DevSecOps-EphemeralCompute-EvidencePipeline/examples/iac/serverless/serverless.yml",
    "function": "ingest",
    "severity": "MEDIUM",
    "message": "Function not VPC-attached: egress is less CIDR-bounded (model via identity + trigger graph)",
    "evidence": {}
  },
  {
    "file": "/content/drive/MyDrive/DSPM-DevSecOps-EphemeralCompute-EvidencePipeline/examples/iac/serverless/serverless.yml",
    "function": "api",
    "severity": "HIGH",
    "message": "HTTP-triggered function: treat as public invocation surface unless tightly authz-gated",
    "evidence": {
      "event": {
        "http": {
          "path": "/risk",
          "method": "get"
        }
      }
    }
  },
  {
    "file": "/content/drive/MyDrive/DSPM-DevSecOps-EphemeralCompute-EvidencePipeline/examples/iac/serverless/serverless.yml",
    "function": "api",
    "severity": "LOW",
    "message": "Provider logging not explicitly configured; ensure retention + redaction policy",
    "evidence": {
      "provider_logs": {}
    }
  },
  {
    "file": "/content/drive/MyDrive/DSPM-DevSecOps-EphemeralCompute-EvidencePipeline/examples/iac/serverless/serverless.yml",
    "function": "api",
    "severity": "MEDIUM",
    "message": "Function not VPC-attached: egress is less CIDR-bounded (model via identity + trigger graph)",
    "evidence": {}
  }
]